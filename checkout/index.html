<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel='shortcut icon' type='image/x-icon' href='favicon.png' />

    <title>Checkout workruit</title>
    <link rel='shortcut icon' type='image/x-icon' href='../favicon.png' />
    <link rel="stylesheet" type="text/css" href="https://getbootstrap.com/docs/4.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/custom.css" />

    <!-- Custom styles for this template -->
    <!-- <link href="form-validation.css" rel="stylesheet"> -->
</head>

<body>
    <div id="load-header"></div>

    <div class="content price-summary-box d-none">
        <div class="container">
            <div class="row">
                <div class="col-md-6 order-md-1 invisible">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="mb-3 text-uppercase">Billing Details</h4>

                            <div class="form">
                                <form id="loginForm" name="loginForm" role="form" autocomplete="off" novalidate>
                                    <!-- First Name -->
                                    <div class="row">
                                        <div class="form-group col">
                                            <input type="text" class="form-control with-icon icon-user transition"
                                                placeholder="First Name" name="firstname" minlength="3" maxlength="50"
                                                autofocus autocomplete="off" required />
                                        </div>
                                        <!-- Last Name -->
                                        <div class="form-group col">
                                            <input type="text" class="form-control with-icon icon-user transition"
                                                placeholder="Last Name" name="lastname" minlength="3" maxlength="50"
                                                autofocus autocomplete="off" required />
                                        </div>
                                    </div>
                                    <!-- Email -->
                                    <div class="form-group">
                                        <input type="email" class="form-control with-icon icon-mail transition"
                                            name="email" placeholder="Email address" autofocus autocomplete="off"
                                            required />
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-md-6 order-md-2 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h4>Your Items</h4>
                            <div class="border p-3 mb-3">
                                <div class="row">
                                    <div class="col-8">
                                        <p class="text-bold m-0" id="planTitle">Plan A Registration</p>
                                        <!-- <br> -->
                                        <!-- <small><a href="" class="text-muted">View Plane Details</a></small> -->
                                        <!-- <hr> -->
                                        <!-- <select class="custom-select custom-select-sm w-75">
                                            <option selected>Stater</option>
                                            <option value="1">Most popular</option>
                                            <option value="2">Regular</option>
                                        </select> -->
                                        <p class="text-muted mb-1"><span id="timePeriod">0 Days</span> at ₹ <span
                                                id="netprice">000.00</span></p>
                                        <small><a href="" class="text-muted" data-toggle="modal"
                                                data-target="#termsandprivacy">Terms and Privacy</a></small>
                                    </div>
                                    <div class="col-4 text-right">
                                        <p class="text-bold m-0">₹<span id="finalPrice">000.00</span></p>
                                        <!-- <p class="text-bold text-green font-14">25% off</p> -->
                                    </div>
                                </div>
                            </div>
                            <div class="prices-purchase">
                                <div class="price-summary">
                                    <div class="subtotal text-ninth d-flex justify-content-between align-center">
                                        <div class="">Subtotal</div>
                                        <div class="price text-right" id="subtotal">₹000.00</div>
                                    </div>
                                    <div class="taxes-fees text-ninth d-flex justify-content-between align-center">
                                        <span tabindex="0" class="text-default" id="">Taxes <small>GST <span
                                                    id="GSTPercentage"></span></small></span>
                                        <div class="price text-right" id="taxFees">₹00.00</div>
                                    </div>
                                    <div class="promo-add-link d-flex justify-content-between align-center mb-2"><a
                                            class="text-default" data-toggle="modal" data-target="#promoCodeModal">Have
                                            a
                                            promo code?</a>
                                        <div class="price text-right"><span id="promo-price" class="text-green"></span>
                                        </div>
                                    </div>
                                    <div class="total-banner"><label>Total</label>
                                        <div class="price text-secondary" id="totalprice">₹000.00</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <button id="proceed_btn" class="btn btn-outline-primary mt-2">Proceed</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="promoCodeModal" tabindex="-1" role="dialog" aria-labelledby="promoCodeModal"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header pb-0">
                    <h5 id="promoCodeLabel">Have a promo code?</h5>
                    <button type="button" class="close mr-2" data-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body mb-3">
                    <span id="promo-validation" class="text-capitalize text-danger"></span>
                    <form>
                        <div class="form-group mb-3">
                            <label for="PromoCode">Promo Code</label>
                            <input type="text" class="form-control" id="PromoCode" aria-describedby="emailHelp"
                                placeholder="Enter Promo Code" autocomplete="off" value="" maxlength="8">
                        </div>
                        <span class="btn btn-primary applyPromo">Apply</span>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="taxAndFees" tabindex="-1" role="dialog" aria-labelledby="taxAndFees" aria-hidden="true">
        <div role="dialog" aria-label="TaxesFees-modal-dialog" id="TaxesFees-modal-dialog" class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header pb-0">
                    <h2 class="modal-title">Taxes &amp; Fees</h2>
                    <button tabindex="0" type="button" data-action="close" class="close mr-2" data-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="charges-view">
                        <div class="charges-content">
                            <div>
                                <p class="headline-primary mb-0">Taxed items</p>
                                <p class="text-muted m-0">Products not listed are not subject to tax</p>
                                <hr class="my-1">
                                <div class="taxed-item">
                                    <h5 class="headline-primary mb-0">Provided by workruit.com, LLC</h5>
                                    <p class="text-muted">Stater</p>
                                </div>
                            </div>
                            <dl class="taxes-row d-flex justify-content-between align-center mb-0">
                                <dt class="headline-primary">Total taxes</dt>
                                <dd>₹67.35</dd>
                            </dl>
                            <dl class="d-flex justify-content-between align-center mb-0">
                                <dt>Fees</dt>
                                <dd>₹0.00</dd>
                            </dl>
                            <dl class="total-row total-banner ">
                                <dt>
                                    <h3 class="headline-primary">Total</h3>
                                </dt>
                                <dd class="total-price">
                                    <h3 id="total-price">₹67.35</h3>
                                </dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="termsandprivacy" tabindex="-1" role="dialog" aria-labelledby="taxAndFees"
        aria-hidden="true">
        <div role="dialog" aria-label="termsandprivacy-modal-dialog" id="termsandprivacy-modal-dialog"
            class="modal-dialog termsandprivacy-modal">
            <div class="modal-content">
                <div class="modal-header pl-5">
                    <h2 class="modal-title">Terms and Privacy</h2>
                    <button tabindex="0" type="button" data-action="close" class="close mr-2" data-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="termsandprivacy-content">
                        <ul>
                            <li>Discounts are not applicable to ICANN fees, taxes, transfers, premium domains, premium
                                templates, Search Engine Visibility advertising budget, gift cards or Trademark
                                Holders/Priority Pre-registrations or pre-registration fees. Cannot be used in
                                conjuction with any other offer, sale, discount or promotion. After the initial purchase
                                term, discounted products will renew at the then-current renewal list price, Offer good
                                towards new product purchases only and connot be used on product renewals.</li>
                            <li>Private Registration will renew at the regular renewal rate.</li>
                            <li>Savings are based on workruit regular pricing.</li>
                            <li>Annual discounts available on NEW purchases only.</li>
                            <li>Special offer price valid for the specified offer term of one new or transfer domain per
                                customer. After the initial purchase term, additional years or domains may be purchased
                                at the regular or then-current price. Discount offers cannot be used in conjunction with
                                any other offer or promotion. Not all payment methods valid with this offer, acceptable
                                payments will display in cart at checkout. Your discount will be applied in your
                                shopping cart. After the initial purchase term, discounted products will renew at the
                                then-current renewal rate. workruit reserves the right to deny use of this offer and/or
                                cancel domains purchased using this offer if the offer is abused or used fraudulently,
                                as determined by workruit in its sole discretion.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style>
        .text-bold {
            font-weight: bold
        }

        .text-green {
            color: #55bb65;
        }

        .font-14 {
            font-size: 14px
        }

        .checkout-wrapper .checkout-view .checkout-box .checkout-box-col .price-summary .total-banner {
            margin-top: 5px;
        }

        .total-banner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top: 4px solid #000;
            border-bottom: 4px solid #000;
            font-size: 1.5rem;
            padding: 10px 10px 5px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between !important;
            align-items: center;
        }

        .btn-outline-primary {
            border-color: #007bff;
        }
    </style>
    <div id="paytm-checkout"></div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')
    </script>
    <script src="https://getbootstrap.com/docs/4.0/assets/js/vendor/popper.min.js"></script>
    <script src="https://getbootstrap.com/docs/4.0/dist/js/bootstrap.min.js"></script>
    <script src="https://getbootstrap.com/docs/4.0/assets/js/vendor/holder.min.js"></script>
    <script>
        var baseUrl = 'https://stageapi.workruit.com/resume/user/';
        var priceCalculationObj = {
            "planInfo": JSON.parse(atob(window.location.search.split('?')[1])),
            "promoId": '',
            "user_planId": ""
        }
        var priceInfoData = false;
        console.log(priceCalculationObj);
        $(window).ready(function () {
            $('#load-header').load('../includes/user-header.html');
        });
        $(window).ready(function () {
            var loginStatus = localStorage.getItem("userData") !== null ? true : false;
            if (loginStatus === true) {
                $('.status').css('display', 'flex');
                axios.defaults.headers.common['Token'] = localStorage.getItem('sessionId');
                var userData = JSON.parse(localStorage.getItem("userData"));
                // Price Calculation
                var priceCalculationUrl = baseUrl + userData.userId + "/priceCalculation";
                priceCalculationObj.planId = priceCalculationObj.planInfo.planId
                axios.post(priceCalculationUrl, priceCalculationObj)
                    .then(function (response) {
                        console.log(response);
                        console.log(response.data.data);
                        document.getElementById('finalPrice').innerText = response.data.priceInfo.NetAmount;
                        document.getElementById('GSTPercentage').innerText = response.data.priceInfo
                            .GSTPercentage;
                        document.getElementById('taxFees').innerText = response.data.priceInfo.GSTMoney;
                        document.getElementById('timePeriod').innerText = priceCalculationObj.planInfo
                            .timePeriod;
                        document.getElementById('netprice').innerText = response.data.priceInfo.finalPrice;
                        document.getElementById('planTitle').innerText = response.data.priceInfo.PlanTitle;
                        document.getElementById('subtotal').innerText = response.data.priceInfo.NetAmount;
                        document.getElementById('totalprice').innerText = response.data.priceInfo
                            .finalPrice;
                        priceCalculationObj.user_planId = response.data.priceInfo.user_planId
                        var priceInfoData = true;
                        $('.price-summary-box').removeClass('d-none');
                        // $("#finalPrice").text().replace(response.data.data);
                    })
                    .catch(function (error) {
                        console.log(error);
                    });

                $("#proceed_btn").on('click', function () {
                    console.log("procedd");
                    if (priceCalculationObj.planInfo.planId !== 1) {
                        // Paytm Checksum
                        var checkSumUrl = baseUrl + userData.userId + "/plan/" + priceCalculationObj
                            .user_planId + "/getPaytmChecksum";
                        axios.get(checkSumUrl)
                            .then(function (response) {
                                // handle success
                                console.log(response);
                                var paytmInfo = jQuery('<div> ' + response.data.redirectUrl +
                                    '</div>');
                                // console.log(paytmInfo);
                                localStorage.setItem('orderId', paytmInfo.find(
                                        "input[name=ORDER_ID]")
                                    .val());
                                localStorage.setItem('CHECKSUMHASH', paytmInfo.find(
                                    "input[name=CHECKSUMHASH]").val());
                                console.log(response.data);
                                $('#paytm-checkout').html(response.data.redirectUrl)

                                // url = "./paytm.html";
                                // window.location = url
                            })
                            .catch(function (error) {
                                // handle error
                                console.log(error);
                            })
                    } else {
                        var dashboardPath = origin === 'http://devresume.workruit.com' ? origin +
                            '/home/index.html' :
                            origin + '/home/index.html';

                        window.location.replace(dashboardPath);
                    }

                });
                $('#promoCodeModal').on('hidden.bs.modal', function (e) {
                    document.getElementById("promo-validation").innerText = ""
                })
                $('.applyPromo').click(function () {
                    priceCalculationObj.promocode = $('#PromoCode').val();
                    if (priceCalculationObj.promocode) {
                        var settings = {
                            "async": true,
                            "crossDomain": true,
                            "url": baseUrl + userData.userId + "/priceCalculation",
                            "method": "POST",
                            "headers": {
                                "token": "911ca088ab824095b82d3c98b32332e7",
                                "content-type": "application/json"
                            },
                            "processData": false,
                            "data": JSON.stringify(priceCalculationObj)
                        }
                        $.ajax(settings).done(function (response) {
                            if (response.status === "success") {
                                console.log(response.priceInfo.PromocodePrice);
                                $('#promoCodeModal').modal('hide');
                                document.getElementById('PromoCode').value = '';
                                document.getElementById('totalprice').innerText = response
                                    .priceInfo
                                    .finalPrice;
                                document.getElementById('promo-price').innerText = '- ₹ ' +
                                    response
                                    .priceInfo.PromocodePrice
                            } else {
                                document.getElementById("promo-validation").innerText = response
                                    .msg
                                    .description;
                                $('.close').on('click', function () {
                                    // do something…
                                    document.getElementById('PromoCode').value = '';
                                    document.getElementById("promo-validation")
                                        .innerText =
                                        "";
                                })
                            }
                            console.log(response);
                        });
                    } else {
                        document.getElementById("promo-validation").innerText =
                            'Please Enter Promo code';
                    };
                })
            } else {
                $('.status').css('display', 'none')
            }
        })
    </script>
</body>

</html>